Project 1 Part 1
Name: Kienen Mulloy
Submission Date: 11/17/22
Known issues: None

#Most Interesting Solution Reports: PT',  PZ, Pu5, Pw, Pq, Pr

#Create Commands

create table customer(
	customerID int primary key,
	Fname varchar(15) not null,
	Lname varchar(15) not null,
	address varchar(30) not null,
	city varchar(30) not  null,
	state char(2) not null,
	zip char(5) not null);

create table supplier(
	Sname varchar(30) primary key,
	city varchar(30) not null,
	zip char(5) not null);

create table product(
	UPC char(5) primary key,
	Pname varchar(45) not null,
	price decimal(6,2) not null,
	Sname varchar(30),
	amount int not null,
	reorderlevel int not null,
	foreign key (Sname) references supplier (Sname) on delete set null on update cascade);

create table orders(
	orderID int primary key,
	orderdate date not null,
	shipdate date,
	paymenttype enum('VISA', 'MC', 'DISCOVER') not null,
	CCN char(16) not null,
	customerID int not null,
	foreign key (customerID) references customer (customerID) on update cascade);

create table contains(
	orderID int,
	UPC char(5),
	quantity int not null,
	primary key (orderID, UPC),
	foreign key (UPC) references product (UPC) on update cascade,
	foreign key (orderID) references orders (orderID) on delete cascade on update cascade);

create table rated(
	customerID int,
	UPC char(5),
	rating int check (rating>0 and rating<=5) not null,
	ratingdate date not null,
	primary key (customerID, UPC),
	foreign key (customerID) references customer (customerID) on update cascade,
	foreign key (UPC) references product (UPC) on delete cascade on update cascade);

create table wishes(
	customerID int,
	UPC char(5),
	primary key (customerID, UPC),
	foreign key (customerID) references customer (customerID) on delete cascade on update cascade,
	foreign key (UPC) references product (UPC) on delete cascade on update cascade);

create table prod_category(
	UPC char(5),
	category varchar(15),
	primary key (UPC, category),
	foreign key (UPC) references product (UPC) on delete cascade on update cascade);
	
#Load Data Commands

load data local infile '~hristescu/public_html/classes/db/customer.txt' into table customer fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/supplier.txt' into table supplier fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/product.txt' into table product fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/orders.txt' into table orders fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/contains.txt' into table contains fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/rated.txt' into table rated fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/wishes.txt' into table wishes fields terminated by ',';

load data local infile '~hristescu/public_html/classes/db/prod_category.txt' into table prod_category fields terminated by ',';

#Part 1
	
	#Add
	
		insert into supplier values ('Ginsburg', 'Atlantic City', '08401'); 
		
 /*		+----------+---------------+-------+
		| Sname    | city          | zip   |
		+----------+---------------+-------+
		| Ginsburg | Atlantic City | 08401 |
		+----------+---------------+-------+
		1 row in set (0.00 sec) */

		
	#Modify
	
		update supplier
		set city = 'Bellmawr',
			zip = '08031'
		where Sname = 'Ginsburg';
		
	#View
		select * from supplier
		where Sname = 'Ginsburg';
		
 /*		+----------+----------+-------+
		| Sname    | city     | zip   |
		+----------+----------+-------+
		| Ginsburg | Bellmawr | 08031 |
		+----------+----------+-------+
		1 row in set (0.00 sec) */
	
	#Remove
		delete from supplier
		where Sname = 'Ginsburg';

#1d. Ability to view inventory.
	
	select * from product;
	
#1e. Ability to modify inventory (as a result of re-ordering).
	
	update product
	set inventory = inventory + reorderlevel * 1.5;
	where UPC = '00001';
	
#1f. Ability to place an order.
	
	insert into orders values (91, now(), null, 'DISCOVER', '1234123412341234', 3);
	insert into contains values (91, '00001', 2);
	insert into contains values (91, '00035', 10);
	insert into contains values (91, '00042', 1);
	
 /*	+---------+------------+----------+-------------+------------------+------------+
	| orderID | orderdate  | shipdate | paymenttype | CCN              | customerID |
	+---------+------------+----------+-------------+------------------+------------+
	|      91 | 2022-12-07 | NULL     | DISCOVER    | 1234123412341234 |          3 |
	+---------+------------+----------+-------------+------------------+------------+
	1 row in set (0.00 sec) */

 /*	+---------+-------+----------+
	| orderID | UPC   | quantity |
	+---------+-------+----------+
	|      91 | 00001 |        2 |
	|      91 | 00035 |       10 |
	|      91 | 00042 |        1 |
	+---------+-------+----------+
	3 rows in set (0.00 sec) */


#1g. Ability to track an order [if it was shipped(date) or not].
	
	select orderID, shipdate
	from orders
	where orderID = 2;
	
 /*	+---------+------------+
	| orderID | shipdate   |
	+---------+------------+
	|       2 | 2018-06-11 |
	+---------+------------+
	1 row in set (0.00 sec) */
	
#1h. Ability to view, add, and remove products on the wishlist.
	
	insert into wishes values (3, '00043');
	
	select *
	from wishes
	where customerID = 3;
	
 /*	+------------+-------+
	| customerID | UPC   |
	+------------+-------+
	|          3 | 00031 |
	|          3 | 00032 |
	|          3 | 00033 |
	|          3 | 00034 |
	|          3 | 00035 |
	|          3 | 00043 |
	|          3 | 00048 |
	+------------+-------+
	7 rows in set (0.00 sec) */

	delete from wishes
	where customerID = 3 and UPC = '00043';
	
#1i. Ability to rate products.
	
	insert into rated values(3, '00042', 4);
	
 /*	+------------+-------+--------+------------+
	| customerID | UPC   | rating | ratingdate |
	+------------+-------+--------+------------+
	|          3 | 00042 |      4 | 2022-12-07 |
	+------------+-------+--------+------------+
	1 row in set (0.00 sec) */
	
#Pj. List of prospective customers.

	delimiter //
	create procedure Pj()
	begin
		select * 
		from customer
		where customerID not in (select customerID
								 from orders);
	end//
	delimiter ;
	
	call Pj;
 /* +------------+---------+-------------+-------------------+-------------------+-------+-------+
	| customerID | Fname   | Lname       | address           | city              | state | zip   |
	+------------+---------+-------------+-------------------+-------------------+-------+-------+
	|          7 | Joanne  | Mathieu     | 1 N Harlem Ave #9 | Essex             | NJ    | 70503 |
	|         18 | Manito  | Kohnert     | 134 Lewis Rd      | Davidson          | NJ    | 37211 |
	|         21 | Jolene  | Ostolaza    | 1610 14th St Nw   | Newport News City | VA    | 23608 |
	|         31 | Sunny   | Kownacki    | 2 Se 3rd Ave      | Dallas            | TX    | 75149 |
	|         33 | Lilinor | Paskin      | 20113 4th Ave E   | Hudson            | NJ    | 71032 |
	|         43 | Luis    | Jurney      | 25 Se 176th Pl    | Middlesex         | MA    | 82138 |
	|         44 | Rasheed | Sayaphon    | 251 Park Ave #979 | Santa Clara       | CA    | 95070 |
	|         45 | Renea   | Monterrubio | 26 Montgomery St  | Fulton            | GA    | 30328 |
	|         46 | Carmelo | Lindall     | 2664 Lewis Rd     | Douglas           | CA    | 80126 |
	+------------+---------+-------------+-------------------+-------------------+-------+-------+
	9 rows in set (0.00 sec) */


#Pk. List of orders that have not been shipped yet.
	
	delimiter //
	create procedure Pk()
	begin	
		select *
		from orders
		where shipdate is null;
	end//
	delimiter ;
	
	call Pk;
 /* +---------+------------+----------+-------------+------------------+------------+
	| orderID | orderdate  | shipdate | paymenttype | CCN              | customerID |
	+---------+------------+----------+-------------+------------------+------------+
	|       3 | 2018-06-25 | NULL     | VISA        | 4265741118566723 |          8 |
	|      11 | 2019-02-14 | NULL     | VISA        | 3677996829882834 |         47 |
	|      14 | 2019-02-18 | NULL     | DISCOVER    | 5743287564732811 |         13 |
	|      17 | 2019-03-01 | NULL     | DISCOVER    | 4432321234546785 |         23 |
	|      23 | 2019-03-16 | NULL     | MC          | 9182934429948195 |         49 |
	|      30 | 2019-04-01 | NULL     | VISA        | 9339548432521315 |          1 |
	|      33 | 2019-04-13 | NULL     | DISCOVER    | 8789765467658796 |         10 |
	|      34 | 2019-04-13 | NULL     | VISA        | 3234567876758976 |         15 |
	|      35 | 2019-04-14 | NULL     | DISCOVER    | 7678906678432964 |         17 |
	|      37 | 2019-04-15 | NULL     | VISA        | 4456758976543298 |         19 |
	|      44 | 2019-04-27 | NULL     | MC          | 9176952863365214 |         12 |
	|      46 | 2020-01-15 | NULL     | DISCOVER    | 6012426788599159 |         41 |
	|      49 | 2020-01-31 | NULL     | MC          | 5468745248681198 |         34 |
	|      52 | 2021-03-18 | NULL     | VISA        | 4265869811318674 |         28 |
	|      54 | 2021-04-29 | NULL     | VISA        | 1114002556361579 |          3 |
	|      58 | 2021-10-10 | NULL     | DISCOVER    | 6012084174461331 |          4 |
	|      63 | 2022-01-07 | NULL     | MC          | 5432344566789878 |          1 |
	|      68 | 2022-01-17 | NULL     | DISCOVER    | 9334469574159454 |          9 |
	|      84 | 2022-04-10 | NULL     | DISCOVER    | 6012184786257849 |         11 |
	|      87 | 2022-04-17 | NULL     | MC          | 1118499655232199 |         22 |
	|      89 | 2022-04-19 | NULL     | DISCOVER    | 6012768542759725 |         47 |
	+---------+------------+----------+-------------+------------------+------------+
	21 rows in set (0.00 sec) */


#Pl. List of orders that could be shipped (all items in order are in stock in the ordered amounts) in the order in which they have been placed.
	
	delimiter //
	create procedure Pl()
	begin
		with notShipped(orderID) as (select orderID
									 from orders
									 where shipdate is null),
			 notShippableOrders(orderID) as (select orderID
											 from (select *
												   from contains 
												   where orderID in (select orderID from notShipped)) as notShippedContains
												   left join product using (UPC)
											 where quantity > amount)
		select *
		from orders
		where orderID not in (select orderID from notShippableOrders)
			  and orderID in (select orderID from notShipped)
		order by orderdate;
	end//
	delimiter ;
	
	call Pl;
 /* +---------+------------+----------+-------------+------------------+------------+
	| orderID | orderdate  | shipdate | paymenttype | CCN              | customerID |
	+---------+------------+----------+-------------+------------------+------------+
	|      11 | 2019-02-14 | NULL     | VISA        | 3677996829882834 |         47 |
	|      14 | 2019-02-18 | NULL     | DISCOVER    | 5743287564732811 |         13 |
	|      30 | 2019-04-01 | NULL     | VISA        | 9339548432521315 |          1 |
	|      33 | 2019-04-13 | NULL     | DISCOVER    | 8789765467658796 |         10 |
	|      34 | 2019-04-13 | NULL     | VISA        | 3234567876758976 |         15 |
	|      49 | 2020-01-31 | NULL     | MC          | 5468745248681198 |         34 |
	|      54 | 2021-04-29 | NULL     | VISA        | 1114002556361579 |          3 |
	|      58 | 2021-10-10 | NULL     | DISCOVER    | 6012084174461331 |          4 |
	|      87 | 2022-04-17 | NULL     | MC          | 1118499655232199 |         22 |
	|      89 | 2022-04-19 | NULL     | DISCOVER    | 6012768542759725 |         47 |
	+---------+------------+----------+-------------+------------------+------------+
10 rows in set (0.00 sec) */

#Pm. List of products whose inventory is at or below reorder level.
	
	delimiter //
	create procedure Pm()
	begin
		select * 
		from product
		where amount <= reorderlevel;
	end//
	delimiter ;
	
 /*	+-------+---------------------------+--------+--------------------------------+--------+--------------+
	| UPC   | Pname                     | price  | Sname                          | amount | reorderlevel |
	+-------+---------------------------+--------+--------------------------------+--------+--------------+
	| 00002 | Sure Feet Running Shoes   |  59.99 | NK Apparel                     |      6 |           30 |
	| 00003 | Happy Smiles Face Paints  |  19.99 | Bel-Art Products               |      3 |           75 |
	| 00008 | Bass Booster Subwoofers   | 124.99 | Melmarc Products Inc.          |      3 |           10 |
	| 00010 | Sunshine Yellow           |  44.99 | Bel-Art Products               |     10 |           15 |
	| 00015 | Puzzle Blocks for Kids    |  19.99 | HB Products LLC                |      0 |           30 |
	| 00017 | Portable Motion Detector  |  50.00 | Motion Enhanced Technology     |      5 |           10 |
	| 00022 | Travel Coffee Maker       |  39.00 | Cambridge Engineered Solutions |     20 |           50 |
	| 00025 | Talking Doll              |  25.00 | Melmarc Products Inc.          |     12 |           15 |
	| 00027 | Printer Paper             |   4.00 | HB Products LLC                |      0 |           50 |
	| 00029 | Ventilation Filter        |  22.00 | Kaman Industrial Technologies  |      0 |           20 |
	| 00033 | Digital Clock             |  15.00 | Motion Enhanced Technology     |     30 |          150 |
	| 00035 | Transformer Action Figure |   5.00 | Pegatron Products              |     90 |          250 |
	| 00036 | Star Wars Sticker         |   0.50 | Akustica                       |     50 |         2000 |
	| 00040 | Basic Telescope           | 100.00 | Seatec Astronomy               |     10 |           25 |
	| 00042 | Gerber Baby Food          |   5.00 | HB Products LLC                |      0 |           50 |
	| 00045 | Kids Baking Set           |  50.00 | Melmarc Products Inc.          |     20 |           20 |
	| 00046 | Math Card Game            |  10.00 | HB Products LLC                |     13 |           20 |
	| 00048 | X-Ray Goggles             | 100.00 | ProtoVision                    |     14 |           15 |
	+-------+---------------------------+--------+--------------------------------+--------+--------------+
	18 rows in set (0.00 sec) */


#Pn. List of customers who have rated at least one product that they did not buy.
	
	delimiter //
	create procedure Pn()
	begin
		with customerBought(customerID, UPC) as (select customerID, UPC
												 from orders join contains using (orderID)),
			 buylessRater(customerID) as (select customerID
											   from rated
											   where not exists(select * 
											   from customerBought
											   where rated.customerID = customerBought.customerID and
													 rated.UPC = customerBought.UPC))
		select *
		from customer
		where customerID in (select customerID
							 from buylessRater);
	end//
	delimiter ;
	
 /*	+------------+-----------+-------------+-----------------------------+----------------------+-------+-------+
	| customerID | Fname     | Lname       | address                     | city                 | state | zip   |
	+------------+-----------+-------------+-----------------------------+----------------------+-------+-------+
	|          1 | Allene    | Iturbide    | 1 Central Ave               | Portage              | WI    | 54481 |
	|          2 | Marino    | Lueckenbach | 1 Century Park E            | San Diego            | CA    | 92110 |
	|          3 | Twana     | Felger      | 1000 Commerce Way           | Washington           | OR    | 97224 |
	|          4 | Salena    | Karpel      | 1 Garfield Ave #7           | Stark                | OH    | 44707 |
	|          5 | Arminda   | Parvis      | 1 Huntwood Ave              | Maricopa             | CA    | 85017 |
	|          6 | Nicolette | Brossart    | 1 Midway Rd                 | Worcester            | MA    | 15281 |
	|          7 | Joanne    | Mathieu     | 1 N Harlem Ave #9           | Essex                | NJ    | 70503 |
	|          8 | Jacque    | Rowling     | 1 N San Saba                | Erie                 | PA    | 16501 |
	|          9 | Hermin    | Thyberg     | 1 Rancho Del Mar Shopping C | Providence           | RI    | 29103 |
	|         10 | Johann    | Leinenbach  | 1 Washington St             | Palm Beach           | FL    | 33461 |
	|         11 | Roxane    | Campain     | 1048 Main St                | Fairbanks North Star | AK    | 99708 |
	|         12 | Clorinda  | Heimann     | 105 Richmond Valley Rd      | San Diego            | CA    | 92025 |
	|         13 | Regis     | Kannady     | 10759 Main St               | Maricopa             | AZ    | 85260 |
	|         14 | John      | Aladin      | 1088 Pinehurst St           | Orange               | NC    | 27514 |
	|         15 | Arlette   | Honeywell   | 11279 Loytan St             | Duval                | FL    | 32254 |
	|         16 | Aliza     | Baltimore   | 1128 Delaware St            | Santa Clara          | CA    | 95132 |
	|         17 | Carissa   | Batman      | 12270 Caton Center Dr       | Lane                 | OR    | 97401 |
	|         18 | Manito    | Kohnert     | 134 Lewis Rd                | Davidson             | NJ    | 37211 |
	|         19 | Amber     | Monarrez    | 14288 Foster Ave #4121      | Montgomery           | SD    | 19046 |
	|         20 | Danielo   | Perruzza    | 11360 S Halsted St          | Orange               | CA    | 92705 |
	|         21 | Jolene    | Ostolaza    | 1610 14th St Nw             | Newport News City    | VA    | 23608 |
	|         22 | Rozella   | Ostrosky    | 17 Morena Blvd              | Ventura              | CA    | 93012 |
	|         23 | Cyndy     | Goldammer   | 170 Wyoming Ave             | Dakota               | MN    | 55337 |
	|         24 | Angello   | Cetta       | 185 Blackstone Bldge        | Honolulu             | NJ    | 96817 |
	|         26 | Jean      | Claucherty  | 19 Amboy Ave                | Miami-Dade           | ND    | 33142 |
	|         27 | Merlin    | Bayless     | 195 13n N                   | Santa Clara          | CA    | 95054 |
	|         28 | Diane     | Devreese    | 1953 Telegraph Rd           | Buchanan             | MO    | 64504 |
	|         29 | Faliju    | Saylors     | 2 Lighthouse Ave            | Hennepin             | MN    | 55343 |
	|         30 | Katlyn    | Ogg         | 2 S Biscayne Blvd           | Baltimore City       | MD    | 21230 |
	|         31 | Sunny     | Kownacki    | 2 Se 3rd Ave                | Dallas               | TX    | 75149 |
	|         32 | Ray       | Kampa       | 2 Sw Nyberg Rd              | Elkhart              | NJ    | 46514 |
	|         33 | Lilinor   | Paskin      | 20113 4th Ave E             | Hudson               | NJ    | 71032 |
	|         34 | Rebecka   | Gesick      | 2026 N Plankinton Ave #3    | Travis               | TX    | 78754 |
	|         35 | Micael    | Rhymes      | 20932 Hedley St             | Contra Costa         | CA    | 94520 |
	|         36 | Colette   | Kardas      | 21575 S Apple Creek Rd      | Douglas              | NE    | 68124 |
	|         37 | Refugia   | Jacobos     | 2184 Worth St               | Alameda              | CA    | 94545 |
	|         38 | Tresa     | Sweely      | 22 Bridle Ln                | Saint Louis          | CA    | 63088 |
	|         39 | Jesusa    | Shin        | 2239 Shawnee Mission Pky    | Coffee               | WV    | 37388 |
	|         40 | Layla     | Springe     | 229 N Forty Driv            | New York             | NY    | 10011 |
	|         41 | Sheldon   | Zane        | 2409 Alabama Rd             | Riverside            | CA    | 92501 |
	|         42 | Kiley     | Caldarera   | 25 E 75th St #69            | Los Angeles          | ND    | 90034 |
	|         43 | Luis      | Jurney      | 25 Se 176th Pl              | Middlesex            | MA    | 82138 |
	|         44 | Rasheed   | Sayaphon    | 251 Park Ave #979           | Santa Clara          | CA    | 95070 |
	|         45 | Renea     | Monterrubio | 26 Montgomery St            | Fulton               | GA    | 30328 |
	|         46 | Carmelo   | Lindall     | 2664 Lewis Rd               | Douglas              | CA    | 80126 |
	|         47 | Linn      | Paas        | 1 S Pine St                 | Shelby               | TN    | 38112 |
	|         48 | Yuki      | Whobrey     | 1 State Route 27            | Wayne                | MI    | 48180 |
	|         50 | Dean      | Juhas       | 14302 Pennsylvania Ave      | Montgomery           | PA    | 19006 |
	+------------+-----------+-------------+-----------------------------+----------------------+-------+-------+
	48 rows in set (0.01 sec) */


#Po. List of customers who have only rated products that they did not buy.
	
	delimiter //
	create procedure Po()
	begin 
		with customerBought(customerID, UPC) as (select customerID, UPC
												 from orders join contains using (orderID)),
			 buyRater(customerID) as (select customerID
									   from rated
									   where exists(select *
									   from customerBought
									   where rated.customerID = customerBought.customerID and
											 rated.UPC = customerBought.UPC))
		select *
		from customer
		where customerID in (select customerID from rated) and
			customerID not in (select customerID from buyRater);
	end//
	delimiter ;

 /*	+------------+---------+-------------+--------------------------+----------------------+-------+-------+
	| customerID | Fname   | Lname       | address                  | city                 | state | zip   |
	+------------+---------+-------------+--------------------------+----------------------+-------+-------+
	|          4 | Salena  | Karpel      | 1 Garfield Ave #7        | Stark                | OH    | 44707 |
	|          7 | Joanne  | Mathieu     | 1 N Harlem Ave #9        | Essex                | NJ    | 70503 |
	|         10 | Johann  | Leinenbach  | 1 Washington St          | Palm Beach           | FL    | 33461 |
	|         11 | Roxane  | Campain     | 1048 Main St             | Fairbanks North Star | AK    | 99708 |
	|         13 | Regis   | Kannady     | 10759 Main St            | Maricopa             | AZ    | 85260 |
	|         15 | Arlette | Honeywell   | 11279 Loytan St          | Duval                | FL    | 32254 |
	|         18 | Manito  | Kohnert     | 134 Lewis Rd             | Davidson             | NJ    | 37211 |
	|         19 | Amber   | Monarrez    | 14288 Foster Ave #4121   | Montgomery           | SD    | 19046 |
	|         21 | Jolene  | Ostolaza    | 1610 14th St Nw          | Newport News City    | VA    | 23608 |
	|         24 | Angello | Cetta       | 185 Blackstone Bldge     | Honolulu             | NJ    | 96817 |
	|         26 | Jean    | Claucherty  | 19 Amboy Ave             | Miami-Dade           | ND    | 33142 |
	|         31 | Sunny   | Kownacki    | 2 Se 3rd Ave             | Dallas               | TX    | 75149 |
	|         32 | Ray     | Kampa       | 2 Sw Nyberg Rd           | Elkhart              | NJ    | 46514 |
	|         33 | Lilinor | Paskin      | 20113 4th Ave E          | Hudson               | NJ    | 71032 |
	|         36 | Colette | Kardas      | 21575 S Apple Creek Rd   | Douglas              | NE    | 68124 |
	|         39 | Jesusa  | Shin        | 2239 Shawnee Mission Pky | Coffee               | WV    | 37388 |
	|         43 | Luis    | Jurney      | 25 Se 176th Pl           | Middlesex            | MA    | 82138 |
	|         44 | Rasheed | Sayaphon    | 251 Park Ave #979        | Santa Clara          | CA    | 95070 |
	|         45 | Renea   | Monterrubio | 26 Montgomery St         | Fulton               | GA    | 30328 |
	|         46 | Carmelo | Lindall     | 2664 Lewis Rd            | Douglas              | CA    | 80126 |
	|         50 | Dean    | Juhas       | 14302 Pennsylvania Ave   | Montgomery           | PA    | 19006 |
	+------------+---------+-------------+--------------------------+----------------------+-------+-------+
	21 rows in set (0.00 sec) */

#Pp. List of customers who did not rate any products they bought.
	
	delimiter //
	create procedure Pp()
		begin 
			with customerBought(customerID, UPC) as (select customerID, UPC
													 from orders join contains using (orderID)),
				 buyRater(customerID) as (select customerID
										   from rated
										   where exists(select *
										   from customerBought
										   where rated.customerID = customerBought.customerID and
												 rated.UPC = customerBought.UPC))
			select *
			from customer
			where customerID not in (select customerID from buyRater) and
				   customerID in (select customerID from orders);
		end//
		delimiter ;
		
#Pq. List of states where the raters live ordered from most-frequent-rater state to least-frequent-rater state.
	
	delimiter //
	create procedure Pq()
	begin
		select state
		from (select distinct * from rater) join customer using (customerID)
		group by state
		order by count(*);
	end//
	delimiter ;
	
 /*	+------------+----------+------------+--------------------------+----------------------+-------+-------+
	| customerID | Fname    | Lname      | address                  | city                 | state | zip   |
	+------------+----------+------------+--------------------------+----------------------+-------+-------+
	|          4 | Salena   | Karpel     | 1 Garfield Ave #7        | Stark                | OH    | 44707 |
	|         10 | Johann   | Leinenbach | 1 Washington St          | Palm Beach           | FL    | 33461 |
	|         11 | Roxane   | Campain    | 1048 Main St             | Fairbanks North Star | AK    | 99708 |
	|         13 | Regis    | Kannady    | 10759 Main St            | Maricopa             | AZ    | 85260 |
	|         15 | Arlette  | Honeywell  | 11279 Loytan St          | Duval                | FL    | 32254 |
	|         19 | Amber    | Monarrez   | 14288 Foster Ave #4121   | Montgomery           | SD    | 19046 |
	|         24 | Angello  | Cetta      | 185 Blackstone Bldge     | Honolulu             | NJ    | 96817 |
	|         25 | Pareque  | Wide       | 187 Market St            | Fulton               | GA    | 30342 |
	|         26 | Jean     | Claucherty | 19 Amboy Ave             | Miami-Dade           | ND    | 33142 |
	|         32 | Ray      | Kampa      | 2 Sw Nyberg Rd           | Elkhart              | NJ    | 46514 |
	|         36 | Colette  | Kardas     | 21575 S Apple Creek Rd   | Douglas              | NE    | 68124 |
	|         39 | Jesusa   | Shin       | 2239 Shawnee Mission Pky | Coffee               | WV    | 37388 |
	|         49 | Trinidad | Mcrae      | 10276 Brooks St          | San Francisco        | CA    | 94105 |
	|         50 | Dean     | Juhas      | 14302 Pennsylvania Ave   | Montgomery           | PA    | 19006 |
	+------------+----------+------------+--------------------------+----------------------+-------+-------+
	14 rows in set (0.01 sec) */


#Pr. List of "worst selling" products, which might be offered as specials.
	
	delimiter //
	create procedure Pr(maxSales int)
	begin
	with goodSales(UPC) as (select UPC
							from contains
							group by UPC
							having count(UPC) > maxSales)
		select *
		from product
		where UPC not in (select UPC from goodSales);
	end//
	delimiter ;
	
	call Pr(3);
	
 /*	+-------+--------------------+--------+-------------------------------+--------+--------------+
	| UPC   | Pname              | price  | Sname                         | amount | reorderlevel |
	+-------+--------------------+--------+-------------------------------+--------+--------------+
	| 00029 | Ventilation Filter |  22.00 | Kaman Industrial Technologies |      0 |           20 |
	| 00032 | Thermal Sensor     | 350.00 | Hadden Industries             |     15 |            3 |
	| 00043 | Leap Frog Tablet   | 100.00 | Seatec Astronomy              |    100 |           20 |
	+-------+--------------------+--------+-------------------------------+--------+--------------+
	3 rows in set (0.08 sec) */

	call Pr(5);
	
 /*	+-------+----------------------------+--------+--------------------------------+--------+--------------+
	| UPC   | Pname                      | price  | Sname                          | amount | reorderlevel |
	+-------+----------------------------+--------+--------------------------------+--------+--------------+
	| 00006 | No More Stink Socks        |   9.99 | NK Apparel                     |    134 |           60 |
	| 00011 | Job Hunter Discount Suit   |  74.99 | NK Apparel                     |     44 |           30 |
	| 00015 | Puzzle Blocks for Kids     |  19.99 | HB Products LLC                |      0 |           30 |
	| 00020 | Book of Colors and Numbers |   9.99 | C. C. Filson                   |     70 |           10 |
	| 00021 | Mini Acoustic Guitar       |  35.00 | Akustica                       |     50 |           10 |
	| 00022 | Travel Coffee Maker        |  39.00 | Cambridge Engineered Solutions |     20 |           50 |
	| 00026 | Telescope                  | 300.00 | Seatec Astronomy               |     50 |           10 |
	| 00029 | Ventilation Filter         |  22.00 | Kaman Industrial Technologies  |      0 |           20 |
	| 00032 | Thermal Sensor             | 350.00 | Hadden Industries              |     15 |            3 |
	| 00043 | Leap Frog Tablet           | 100.00 | Seatec Astronomy               |    100 |           20 |
	| 00046 | Math Card Game             |  10.00 | HB Products LLC                |     13 |           20 |
	+-------+----------------------------+--------+--------------------------------+--------+--------------+
	11 rows in set (0.00 sec) */

	call Pr(7);
	
 /*	+-------+----------------------------------------+---------+--------------------------------+--------+--------------+
	| UPC   | Pname                                  | price   | Sname                          | amount | reorderlevel |
	+-------+----------------------------------------+---------+--------------------------------+--------+--------------+
	| 00002 | Sure Feet Running Shoes                |   59.99 | NK Apparel                     |      6 |           30 |
	| 00004 | Overpriced Calculator: College Edition |   99.99 | ViTech Scientific              |     20 |            5 |
	| 00005 | Super-Sensor Door Opener               |  120.00 | Motion Enhanced Technology     |      4 |            2 |
	| 00006 | No More Stink Socks                    |    9.99 | NK Apparel                     |    134 |           60 |
	| 00007 | Far Out! Telescope                     | 1099.99 | Seatec Astronomy               |      3 |            1 |
	| 00011 | Job Hunter Discount Suit               |   74.99 | NK Apparel                     |     44 |           30 |
	| 00013 | The Overclocker: Extreme CPU           |  349.99 | Melmarc Products Inc.          |     32 |           30 |
	| 00015 | Puzzle Blocks for Kids                 |   19.99 | HB Products LLC                |      0 |           30 |
	| 00016 | Chef Gourmet Pasta                     |    8.00 | PolyOne                        |     50 |           10 |
	| 00018 | Smart Cooker                           |   65.00 | Pegatron Products              |    150 |           20 |
	| 00020 | Book of Colors and Numbers             |    9.99 | C. C. Filson                   |     70 |           10 |
	| 00021 | Mini Acoustic Guitar                   |   35.00 | Akustica                       |     50 |           10 |
	| 00022 | Travel Coffee Maker                    |   39.00 | Cambridge Engineered Solutions |     20 |           50 |
	| 00024 | Winter Jacket                          |   55.00 | NK Apparel                     |    100 |           20 |
	| 00025 | Talking Doll                           |   25.00 | Melmarc Products Inc.          |     12 |           15 |
	| 00026 | Telescope                              |  300.00 | Seatec Astronomy               |     50 |           10 |
	| 00027 | Printer Paper                          |    4.00 | HB Products LLC                |      0 |           50 |
	| 00029 | Ventilation Filter                     |   22.00 | Kaman Industrial Technologies  |      0 |           20 |
	| 00030 | Surface Pro 4                          |  600.00 | UCA Group Inc.                 |     30 |           10 |
	| 00032 | Thermal Sensor                         |  350.00 | Hadden Industries              |     15 |            3 |
	| 00034 | Sweater                                |   34.99 | NK Apparel                     |    100 |           25 |
	| 00039 | Calculus Book                          |   50.00 | HB Products LLC                |    250 |           50 |
	| 00040 | Basic Telescope                        |  100.00 | Seatec Astronomy               |     10 |           25 |
	| 00041 | High End Telescope                     |  100.00 | Seatec Astronomy               |    100 |           20 |
	| 00042 | Gerber Baby Food                       |    5.00 | HB Products LLC                |      0 |           50 |
	| 00043 | Leap Frog Tablet                       |  100.00 | Seatec Astronomy               |    100 |           20 |
	| 00045 | Kids Baking Set                        |   50.00 | Melmarc Products Inc.          |     20 |           20 |
	| 00046 | Math Card Game                         |   10.00 | HB Products LLC                |     13 |           20 |
	| 00047 | Learn To Drive Game                    |   50.00 | Melmarc Products Inc.          |    200 |           25 |
	| 00048 | X-Ray Goggles                          |  100.00 | ProtoVision                    |     14 |           15 |
	| 00049 | Babys First Game Console               |  150.00 | Motion Enhanced Technology     |    100 |           20 |
	| 00050 | Baby Learns German                     |   50.00 | Aleris International Inc.      |    175 |           20 |
	+-------+----------------------------------------+---------+--------------------------------+--------+--------------+
	32 rows in set (0.06 sec) */

#Ps. List of customers who have not been "too active" and for whom special offers should be made.
	
	delimiter //
	create procedure Ps(latestDate date)
	begin
		with activeCustomers(customerID) as (select customerID
											   from orders
											   where orderdate > latestDate)
		select *
		from customer
		where customerID not in (select customerID from activeCustomers)
			  and customerID in (select customerID from orders);
	end//
	delimiter ;
	
	call Ps('2021-03-20');

 /*	+------------+-----------+------------+--------------------------+---------------+-------+-------+
	| customerID | Fname     | Lname      | address                  | city          | state | zip   |
	+------------+-----------+------------+--------------------------+---------------+-------+-------+
	|          6 | Nicolette | Brossart   | 1 Midway Rd              | Worcester     | MA    | 15281 |
	|          8 | Jacque    | Rowling    | 1 N San Saba             | Erie          | PA    | 16501 |
	|         10 | Johann    | Leinenbach | 1 Washington St          | Palm Beach    | FL    | 33461 |
	|         12 | Clorinda  | Heimann    | 105 Richmond Valley Rd   | San Diego     | CA    | 92025 |
	|         15 | Arlette   | Honeywell  | 11279 Loytan St          | Duval         | FL    | 32254 |
	|         17 | Carissa   | Batman     | 12270 Caton Center Dr    | Lane          | OR    | 97401 |
	|         25 | Pareque   | Wide       | 187 Market St            | Fulton        | GA    | 30342 |
	|         28 | Diane     | Devreese   | 1953 Telegraph Rd        | Buchanan      | MO    | 64504 |
	|         32 | Ray       | Kampa      | 2 Sw Nyberg Rd           | Elkhart       | NJ    | 46514 |
	|         34 | Rebecka   | Gesick     | 2026 N Plankinton Ave #3 | Travis        | TX    | 78754 |
	|         36 | Colette   | Kardas     | 21575 S Apple Creek Rd   | Douglas       | NE    | 68124 |
	|         41 | Sheldon   | Zane       | 2409 Alabama Rd          | Riverside     | CA    | 92501 |
	|         42 | Kiley     | Caldarera  | 25 E 75th St #69         | Los Angeles   | ND    | 90034 |
	|         48 | Yuki      | Whobrey    | 1 State Route 27         | Wayne         | MI    | 48180 |
	|         49 | Trinidad  | Mcrae      | 10276 Brooks St          | San Francisco | CA    | 94105 |
	+------------+-----------+------------+--------------------------+---------------+-------+-------+
	15 rows in set (0.00 sec) */
	
	call Ps('2020-04-30');
 /*	+------------+-----------+------------+--------------------------+---------------+-------+-------+
	| customerID | Fname     | Lname      | address                  | city          | state | zip   |
	+------------+-----------+------------+--------------------------+---------------+-------+-------+
	|          6 | Nicolette | Brossart   | 1 Midway Rd              | Worcester     | MA    | 15281 |
	|          8 | Jacque    | Rowling    | 1 N San Saba             | Erie          | PA    | 16501 |
	|         10 | Johann    | Leinenbach | 1 Washington St          | Palm Beach    | FL    | 33461 |
	|         12 | Clorinda  | Heimann    | 105 Richmond Valley Rd   | San Diego     | CA    | 92025 |
	|         15 | Arlette   | Honeywell  | 11279 Loytan St          | Duval         | FL    | 32254 |
	|         17 | Carissa   | Batman     | 12270 Caton Center Dr    | Lane          | OR    | 97401 |
	|         25 | Pareque   | Wide       | 187 Market St            | Fulton        | GA    | 30342 |
	|         32 | Ray       | Kampa      | 2 Sw Nyberg Rd           | Elkhart       | NJ    | 46514 |
	|         34 | Rebecka   | Gesick     | 2026 N Plankinton Ave #3 | Travis        | TX    | 78754 |
	|         36 | Colette   | Kardas     | 21575 S Apple Creek Rd   | Douglas       | NE    | 68124 |
	|         41 | Sheldon   | Zane       | 2409 Alabama Rd          | Riverside     | CA    | 92501 |
	|         42 | Kiley     | Caldarera  | 25 E 75th St #69         | Los Angeles   | ND    | 90034 |
	|         48 | Yuki      | Whobrey    | 1 State Route 27         | Wayne         | MI    | 48180 |
	|         49 | Trinidad  | Mcrae      | 10276 Brooks St          | San Francisco | CA    | 94105 |
	+------------+-----------+------------+--------------------------+---------------+-------+-------+
	14 rows in set (0.00 sec) */
	
	call Ps('2019-02-14');
	
 /*	+------------+--------+---------+--------------+------+-------+-------+
	| customerID | Fname  | Lname   | address      | city | state | zip   |
	+------------+--------+---------+--------------+------+-------+-------+
	|          8 | Jacque | Rowling | 1 N San Saba | Erie | PA    | 16501 |
	+------------+--------+---------+--------------+------+-------+-------+
	1 row in set (0.00 sec) */


#Pt. List of highly wished products.
	
	delimiter //
	create procedure Pt(minWishes int)
	begin
		with highlyWished(UPC) as (select UPC
									from wishes
									group by UPC
									having count(UPC) > minWishes)
		select *
		from product
		where UPC in (select UPC from highlyWished);
	end//
	delimiter ;
	
	call Pt(10)
	
 /*	+-------+--------------------------+-------+----------------------------+--------+--------------+
	| UPC   | Pname                    | price | Sname                      | amount | reorderlevel |
	+-------+--------------------------+-------+----------------------------+--------+--------------+
	| 00011 | Job Hunter Discount Suit | 74.99 | NK Apparel                 |     44 |           30 |
	| 00012 | Head Secure Hard Hat     | 59.99 | Grainger Industrial Supply |     40 |           20 |
	| 00016 | Chef Gourmet Pasta       |  8.00 | PolyOne                    |     50 |           10 |
	| 00021 | Mini Acoustic Guitar     | 35.00 | Akustica                   |     50 |           10 |
	+-------+--------------------------+-------+----------------------------+--------+--------------+
	4 rows in set (0.04 sec) */
	
	call Pt(7)
	
 /*	+-------+------------------------------+--------+--------------------------------+--------+--------------+
	| UPC   | Pname                        | price  | Sname                          | amount | reorderlevel |
	+-------+------------------------------+--------+--------------------------------+--------+--------------+
	| 00001 | Xtreme Graphics 5000         | 399.99 | Melmarc Products Inc.          |     50 |           10 |
	| 00003 | Happy Smiles Face Paints     |  19.99 | Bel-Art Products               |      3 |           75 |
	| 00005 | Super-Sensor Door Opener     | 120.00 | Motion Enhanced Technology     |      4 |            2 |
	| 00006 | No More Stink Socks          |   9.99 | NK Apparel                     |    134 |           60 |
	| 00008 | Bass Booster Subwoofers      | 124.99 | Melmarc Products Inc.          |      3 |           10 |
	| 00011 | Job Hunter Discount Suit     |  74.99 | NK Apparel                     |     44 |           30 |
	| 00012 | Head Secure Hard Hat         |  59.99 | Grainger Industrial Supply     |     40 |           20 |
	| 00013 | The Overclocker: Extreme CPU | 349.99 | Melmarc Products Inc.          |     32 |           30 |
	| 00014 | DG Camera                    | 120.00 | ProtoVision                    |    150 |           20 |
	| 00015 | Puzzle Blocks for Kids       |  19.99 | HB Products LLC                |      0 |           30 |
	| 00016 | Chef Gourmet Pasta           |   8.00 | PolyOne                        |     50 |           10 |
	| 00021 | Mini Acoustic Guitar         |  35.00 | Akustica                       |     50 |           10 |
	| 00022 | Travel Coffee Maker          |  39.00 | Cambridge Engineered Solutions |     20 |           50 |
	| 00030 | Surface Pro 4                | 600.00 | UCA Group Inc.                 |     30 |           10 |
	| 00031 | Sunglasses                   |  50.00 | ProtoVision                    |     75 |           15 |
	| 00034 | Sweater                      |  34.99 | NK Apparel                     |    100 |           25 |
	| 00040 | Basic Telescope              | 100.00 | Seatec Astronomy               |     10 |           25 |
	+-------+------------------------------+--------+--------------------------------+--------+--------------+
	17 rows in set (0.00 sec) */

#Pt'. List of top x% highly wished products.
	
	delimiter //
	create procedure Pt2(percentage int)
	begin
		declare topAmount int;
		set topAmount = (select count(distinct UPC) 
						 from wishes) * (percentage / 100);
		with topWished(UPC) as (select UPC
									from wishes
									group by UPC
									order by count(*)
									limit topAmount)
		select *
		from product
		where UPC in (select UPC from topWished);
	end//
	delimiter ;
	
	call Pt2(50);
	
 /*	+-------+----------------------------------------+---------+-------------------------------+--------+--------------+
	| UPC   | Pname                                  | price   | Sname                         | amount | reorderlevel |
	+-------+----------------------------------------+---------+-------------------------------+--------+--------------+
	| 00002 | Sure Feet Running Shoes                |   59.99 | NK Apparel                    |      6 |           30 |
	| 00004 | Overpriced Calculator: College Edition |   99.99 | ViTech Scientific             |     20 |            5 |
	| 00009 | Star Gazer Junior                      |   39.99 | Seatec Astronomy              |     55 |           35 |
	| 00017 | Portable Motion Detector               |   50.00 | Motion Enhanced Technology    |      5 |           10 |
	| 00018 | Smart Cooker                           |   65.00 | Pegatron Products             |    150 |           20 |
	| 00020 | Book of Colors and Numbers             |    9.99 | C. C. Filson                  |     70 |           10 |
	| 00023 | Car Stereo System                      |   60.00 | Kaman Industrial Technologies |     50 |           10 |
	| 00024 | Winter Jacket                          |   55.00 | NK Apparel                    |    100 |           20 |
	| 00025 | Talking Doll                           |   25.00 | Melmarc Products Inc.         |     12 |           15 |
	| 00026 | Telescope                              |  300.00 | Seatec Astronomy              |     50 |           10 |
	| 00027 | Printer Paper                          |    4.00 | HB Products LLC               |      0 |           50 |
	| 00029 | Ventilation Filter                     |   22.00 | Kaman Industrial Technologies |      0 |           20 |
	| 00032 | Thermal Sensor                         |  350.00 | Hadden Industries             |     15 |            3 |
	| 00033 | Digital Clock                          |   15.00 | Motion Enhanced Technology    |     30 |          150 |
	| 00035 | Transformer Action Figure              |    5.00 | Pegatron Products             |     90 |          250 |
	| 00036 | Star Wars Sticker                      |    0.50 | Akustica                      |     50 |         2000 |
	| 00037 | Smartwatch                             |  250.00 | ViTech Scientific             |     50 |           10 |
	| 00038 | Winnie the Pooh Book                   |    7.99 | C. C. Filson                  |     80 |           20 |
	| 00039 | Calculus Book                          |   50.00 | HB Products LLC               |    250 |           50 |
	| 00041 | High End Telescope                     |  100.00 | Seatec Astronomy              |    100 |           20 |
	| 00044 | Robot Chef                             | 4999.99 | ViTech Scientific             |     75 |           10 |
	| 00046 | Math Card Game                         |   10.00 | HB Products LLC               |     13 |           20 |
	| 00047 | Learn To Drive Game                    |   50.00 | Melmarc Products Inc.         |    200 |           25 |
	| 00048 | X-Ray Goggles                          |  100.00 | ProtoVision                   |     14 |           15 |
	| 00049 | Babys First Game Console               |  150.00 | Motion Enhanced Technology    |    100 |           20 |
	+-------+----------------------------------------+---------+-------------------------------+--------+--------------+
	25 rows in set (0.00 sec) */
	
	call Pt2(25);
	
 /*	+-------+----------------------------------------+--------+-------------------------------+--------+--------------+
	| UPC   | Pname                                  | price  | Sname                         | amount | reorderlevel |
	+-------+----------------------------------------+--------+-------------------------------+--------+--------------+
	| 00049 | Babys First Game Console               | 150.00 | Motion Enhanced Technology    |    100 |           20 |
	| 00033 | Digital Clock                          |  15.00 | Motion Enhanced Technology    |     30 |          150 |
	| 00029 | Ventilation Filter                     |  22.00 | Kaman Industrial Technologies |      0 |           20 |
	| 00039 | Calculus Book                          |  50.00 | HB Products LLC               |    250 |           50 |
	| 00037 | Smartwatch                             | 250.00 | ViTech Scientific             |     50 |           10 |
	| 00004 | Overpriced Calculator: College Edition |  99.99 | ViTech Scientific             |     20 |            5 |
	| 00023 | Car Stereo System                      |  60.00 | Kaman Industrial Technologies |     50 |           10 |
	| 00046 | Math Card Game                         |  10.00 | HB Products LLC               |     13 |           20 |
	| 00002 | Sure Feet Running Shoes                |  59.99 | NK Apparel                    |      6 |           30 |
	| 00024 | Winter Jacket                          |  55.00 | NK Apparel                    |    100 |           20 |
	| 00036 | Star Wars Sticker                      |   0.50 | Akustica                      |     50 |         2000 |
	| 00017 | Portable Motion Detector               |  50.00 | Motion Enhanced Technology    |      5 |           10 |
	| 00020 | Book of Colors and Numbers             |   9.99 | C. C. Filson                  |     70 |           10 |
	+-------+----------------------------------------+--------+-------------------------------+--------+--------------+
	13 rows in set (0.04 sec) */

	call Pt2(5);
	
 /*	+-------+--------------------------+--------+-------------------------------+--------+--------------+
	| UPC   | Pname                    | price  | Sname                         | amount | reorderlevel |
	+-------+--------------------------+--------+-------------------------------+--------+--------------+
	| 00049 | Babys First Game Console | 150.00 | Motion Enhanced Technology    |    100 |           20 |
	| 00029 | Ventilation Filter       |  22.00 | Kaman Industrial Technologies |      0 |           20 |
	| 00033 | Digital Clock            |  15.00 | Motion Enhanced Technology    |     30 |          150 |
	+-------+--------------------------+--------+-------------------------------+--------+--------------+
	3 rows in set (0.00 sec) */


#Pu1. List of highly rated products. (Average)
	
	delimiter //
	create procedure Pu1(minRating float)
	begin
		with topRated(UPC) as (select UPC
								from rated
								group by UPC
								having avg(rating) >= minRating)
		select *
		from product
		where UPC in (select UPC from topRated);
	end//
	delimiter ;
	
	call Pu1(4);
	
 /*	+-------+--------------------------+--------+----------------------------+--------+--------------+
	| UPC   | Pname                    | price  | Sname                      | amount | reorderlevel |
	+-------+--------------------------+--------+----------------------------+--------+--------------+
	| 00014 | DG Camera                | 120.00 | ProtoVision                |    150 |           20 |
	| 00019 | Summer Dress             |  19.00 | Bel-Art Products           |    250 |           35 |
	| 00040 | Basic Telescope          | 100.00 | Seatec Astronomy           |     10 |           25 |
	| 00045 | Kids Baking Set          |  50.00 | Melmarc Products Inc.      |     20 |           20 |
	| 00049 | Babys First Game Console | 150.00 | Motion Enhanced Technology |    100 |           20 |
	| 00050 | Baby Learns German       |  50.00 | Aleris International Inc.  |    175 |           20 |
	+-------+--------------------------+--------+----------------------------+--------+--------------+
	6 rows in set (0.01 sec) */
	
	call Pu1(4.5);
	
 /*	+-------+-----------------+--------+-----------------------+--------+--------------+
	| UPC   | Pname           | price  | Sname                 | amount | reorderlevel |
	+-------+-----------------+--------+-----------------------+--------+--------------+
	| 00040 | Basic Telescope | 100.00 | Seatec Astronomy      |     10 |           25 |
	| 00045 | Kids Baking Set |  50.00 | Melmarc Products Inc. |     20 |           20 |
	+-------+-----------------+--------+-----------------------+--------+--------------+
	2 rows in set (0.00 sec) */
	
	call Pu1(5);
	
 /*	+-------+-----------------+--------+------------------+--------+--------------+
	| UPC   | Pname           | price  | Sname            | amount | reorderlevel |
	+-------+-----------------+--------+------------------+--------+--------------+
	| 00040 | Basic Telescope | 100.00 | Seatec Astronomy |     10 |           25 |
	+-------+-----------------+--------+------------------+--------+--------------+
	1 row in set (0.00 sec) */



#Pu2. List of highly rated products. (A2)

#Chose to have other values be used as thresholds that must be met to be counted.
	delimiter //
	create procedure Pu2(minOrderNum int, minRating float)
		begin
			with topRated(UPC) as (select UPC
									from rated join contains using (UPC)
									group by UPC
									having avg(rating) >= minRating and 
									count(distinct orderID) >= minOrderNum)
			select *
			from product
			where UPC in (select UPC from topRated);
		end//
		delimiter ;
		
		call Pu2(10, 3)//
		
	 /*	+-------+-------------------+---------+-------------------------------+--------+--------------+
		| UPC   | Pname             | price   | Sname                         | amount | reorderlevel |
		+-------+-------------------+---------+-------------------------------+--------+--------------+
		| 00023 | Car Stereo System |   60.00 | Kaman Industrial Technologies |     50 |           10 |
		| 00028 | AC Unit           | 2000.00 | Large System Distributors     |     10 |            4 |
		+-------+-------------------+---------+-------------------------------+--------+--------------+
		2 rows in set (0.01 sec) */
		
		call Pu2(8,4)//
		
	 /*	+-------+--------------+--------+------------------+--------+--------------+
		| UPC   | Pname        | price  | Sname            | amount | reorderlevel |
		+-------+--------------+--------+------------------+--------+--------------+
		| 00014 | DG Camera    | 120.00 | ProtoVision      |    150 |           20 |
		| 00019 | Summer Dress |  19.00 | Bel-Art Products |    250 |           35 |
		+-------+--------------+--------+------------------+--------+--------------+
		2 rows in set (0.01 sec) */


	
#Pu3. List of highly rated products. (B)

	#Chose to have other values be used as thresholds that must be met to be counted.
	delimiter //
	create procedure Pu3(minMaxRating int, minRating float)
		begin
			with topRated(UPC) as (select UPC
									from rated
									group by UPC
									having avg(rating) >= minRating and 
									max(rating) >= minMaxRating)
			select *
			from product
			where UPC in (select UPC from topRated);
		end//
		delimiter ;
		
		call Pu3(5, 4.5);
		
	 /*	+-------+-----------------+--------+-----------------------+--------+--------------+
		| UPC   | Pname           | price  | Sname                 | amount | reorderlevel |
		+-------+-----------------+--------+-----------------------+--------+--------------+
		| 00040 | Basic Telescope | 100.00 | Seatec Astronomy      |     10 |           25 |
		| 00045 | Kids Baking Set |  50.00 | Melmarc Products Inc. |     20 |           20 |
		+-------+-----------------+--------+-----------------------+--------+--------------+
		2 rows in set (0.00 sec) */
		
		call Pu3(5, 3.5);
		
	 /*	+-------+----------------------------+--------+----------------------------+--------+--------------+
		| UPC   | Pname                      | price  | Sname                      | amount | reorderlevel |
		+-------+----------------------------+--------+----------------------------+--------+--------------+
		| 00005 | Super-Sensor Door Opener   | 120.00 | Motion Enhanced Technology |      4 |            2 |
		| 00010 | Sunshine Yellow            |  44.99 | Bel-Art Products           |     10 |           15 |
		| 00012 | Head Secure Hard Hat       |  59.99 | Grainger Industrial Supply |     40 |           20 |
		| 00014 | DG Camera                  | 120.00 | ProtoVision                |    150 |           20 |
		| 00015 | Puzzle Blocks for Kids     |  19.99 | HB Products LLC            |      0 |           30 |
		| 00019 | Summer Dress               |  19.00 | Bel-Art Products           |    250 |           35 |
		| 00020 | Book of Colors and Numbers |   9.99 | C. C. Filson               |     70 |           10 |
		| 00030 | Surface Pro 4              | 600.00 | UCA Group Inc.             |     30 |           10 |
		| 00035 | Transformer Action Figure  |   5.00 | Pegatron Products          |     90 |          250 |
		| 00040 | Basic Telescope            | 100.00 | Seatec Astronomy           |     10 |           25 |
		| 00045 | Kids Baking Set            |  50.00 | Melmarc Products Inc.      |     20 |           20 |
		| 00049 | Babys First Game Console   | 150.00 | Motion Enhanced Technology |    100 |           20 |
		| 00050 | Baby Learns German         |  50.00 | Aleris International Inc.  |    175 |           20 |
		+-------+----------------------------+--------+----------------------------+--------+--------------+
		13 rows in set (0.00 sec) */
		
		call Pu3(4, 4.5);
		
	 /*	+-------+--------------------------+--------+----------------------------+--------+--------------+
		| UPC   | Pname                    | price  | Sname                      | amount | reorderlevel |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		| 00014 | DG Camera                | 120.00 | ProtoVision                |    150 |           20 |
		| 00019 | Summer Dress             |  19.00 | Bel-Art Products           |    250 |           35 |
		| 00040 | Basic Telescope          | 100.00 | Seatec Astronomy           |     10 |           25 |
		| 00045 | Kids Baking Set          |  50.00 | Melmarc Products Inc.      |     20 |           20 |
		| 00049 | Babys First Game Console | 150.00 | Motion Enhanced Technology |    100 |           20 |
		| 00050 | Baby Learns German       |  50.00 | Aleris International Inc.  |    175 |           20 |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		6 rows in set (0.01 sec) */


	
#Pu4. List of highly rated products. (C)

	#Chose to have other values be used as thresholds that must be met to be counted.
	delimiter //
	create procedure Pu4(minRatingCount int, minCustomer int, minDays int, minRating float)
		begin
			with topRated(UPC) as (select UPC
									from rated
									group by UPC
									having avg(rating) >= minRating and 
											count(*) >= minRatingCount and 
											count(distinct customerID) >= minCustomer and 
											datediff(now(),min(ratingdate)) >= minDays)
			select *
			from product
			where UPC in (select UPC from topRated);
		end//
		delimiter ;
		
		call Pu4(5, 3, 2, 4);
		
	 /*	+-------+--------------------------+--------+----------------------------+--------+--------------+
		| UPC   | Pname                    | price  | Sname                      | amount | reorderlevel |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		| 00019 | Summer Dress             |  19.00 | Bel-Art Products           |    250 |           35 |
		| 00049 | Babys First Game Console | 150.00 | Motion Enhanced Technology |    100 |           20 |
		| 00050 | Baby Learns German       |  50.00 | Aleris International Inc.  |    175 |           20 |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		3 rows in set (0.00 sec) */
		
		call Pu4(10, 2, 5, 3);
		
	 /*	+-------+---------------------------+---------+----------------------------+--------+--------------+
		| UPC   | Pname                     | price   | Sname                      | amount | reorderlevel |
		+-------+---------------------------+---------+----------------------------+--------+--------------+
		| 00027 | Printer Paper             |    4.00 | HB Products LLC            |      0 |           50 |
		| 00028 | AC Unit                   | 2000.00 | Large System Distributors  |     10 |            4 |
		| 00030 | Surface Pro 4             |  600.00 | UCA Group Inc.             |     30 |           10 |
		| 00033 | Digital Clock             |   15.00 | Motion Enhanced Technology |     30 |          150 |
		| 00034 | Sweater                   |   34.99 | NK Apparel                 |    100 |           25 |
		| 00035 | Transformer Action Figure |    5.00 | Pegatron Products          |     90 |          250 |
		| 00038 | Winnie the Pooh Book      |    7.99 | C. C. Filson               |     80 |           20 |
		+-------+---------------------------+---------+----------------------------+--------+--------------+
		7 rows in set (0.00 sec) */


	#Pu5. List of highly rated products. (D)

	#Chose to have other values be used as thresholds that must be met to be counted.
	delimiter //
	create procedure Pu5(minRatingCount int, minOrderCount int, minCustomer int, minRating float)
		begin
			with topRated(UPC) as (select UPC
									from rated join contains using (UPC)
									group by UPC
									having avg(rating) >= minRating and
											count(*) >= minRatingCount and
											count(distinct orderID) >= minOrderCount and
											count(distinct customerID) >= minCustomer)
			select *
			from product
			where UPC in (select UPC from topRated);
		end//
		delimiter ;
		
		call Pu5(10, 4, 3, 4);
		
	 /*	+-------+--------------------------+--------+----------------------------+--------+--------------+
		| UPC   | Pname                    | price  | Sname                      | amount | reorderlevel |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		| 00014 | DG Camera                | 120.00 | ProtoVision                |    150 |           20 |
		| 00019 | Summer Dress             |  19.00 | Bel-Art Products           |    250 |           35 |
		| 00040 | Basic Telescope          | 100.00 | Seatec Astronomy           |     10 |           25 |
		| 00045 | Kids Baking Set          |  50.00 | Melmarc Products Inc.      |     20 |           20 |
		| 00049 | Babys First Game Console | 150.00 | Motion Enhanced Technology |    100 |           20 |
		| 00050 | Baby Learns German       |  50.00 | Aleris International Inc.  |    175 |           20 |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		6 rows in set (0.00 sec) */

		call Pu5(0, 7, 3, 4);

	 /*	+-------+-----------------+--------+-----------------------+--------+--------------+
		| UPC   | Pname           | price  | Sname                 | amount | reorderlevel |
		+-------+-----------------+--------+-----------------------+--------+--------------+
		| 00014 | DG Camera       | 120.00 | ProtoVision           |    150 |           20 |
		| 00019 | Summer Dress    |  19.00 | Bel-Art Products      |    250 |           35 |
		| 00040 | Basic Telescope | 100.00 | Seatec Astronomy      |     10 |           25 |
		| 00045 | Kids Baking Set |  50.00 | Melmarc Products Inc. |     20 |           20 |
		+-------+-----------------+--------+-----------------------+--------+--------------+
		4 rows in set (0.01 sec) */

#Pv. List of wished products that have never been bought by the customers who wish them.
	
	delimiter //
	create procedure Pv()
	begin
		with customerBought(customerID, UPC) as (select customerID, UPC
													 from orders join contains using (orderID)),
				 wishBuy(UPC) as (select UPC
										   from wishes
										   where exists(select *
										   from customerBought
										   where wishes.customerID = customerBought.customerID and
												 wishes.UPC = customerBought.UPC))
		select *
		from product
		where UPC not in (select UPC from wishBuy);
	end//
	delimiter ;
	
	call Pv;
	
 /*	+-------+------------------------------+---------+--------------------------------+--------+--------------+
	| UPC   | Pname                        | price   | Sname                          | amount | reorderlevel |
	+-------+------------------------------+---------+--------------------------------+--------+--------------+
	| 00006 | No More Stink Socks          |    9.99 | NK Apparel                     |    134 |           60 |
	| 00007 | Far Out! Telescope           | 1099.99 | Seatec Astronomy               |      3 |            1 |
	| 00009 | Star Gazer Junior            |   39.99 | Seatec Astronomy               |     55 |           35 |
	| 00012 | Head Secure Hard Hat         |   59.99 | Grainger Industrial Supply     |     40 |           20 |
	| 00013 | The Overclocker: Extreme CPU |  349.99 | Melmarc Products Inc.          |     32 |           30 |
	| 00015 | Puzzle Blocks for Kids       |   19.99 | HB Products LLC                |      0 |           30 |
	| 00019 | Summer Dress                 |   19.00 | Bel-Art Products               |    250 |           35 |
	| 00021 | Mini Acoustic Guitar         |   35.00 | Akustica                       |     50 |           10 |
	| 00022 | Travel Coffee Maker          |   39.00 | Cambridge Engineered Solutions |     20 |           50 |
	| 00024 | Winter Jacket                |   55.00 | NK Apparel                     |    100 |           20 |
	| 00026 | Telescope                    |  300.00 | Seatec Astronomy               |     50 |           10 |
	| 00029 | Ventilation Filter           |   22.00 | Kaman Industrial Technologies  |      0 |           20 |
	| 00032 | Thermal Sensor               |  350.00 | Hadden Industries              |     15 |            3 |
	| 00034 | Sweater                      |   34.99 | NK Apparel                     |    100 |           25 |
	| 00046 | Math Card Game               |   10.00 | HB Products LLC                |     13 |           20 |
	| 00047 | Learn To Drive Game          |   50.00 | Melmarc Products Inc.          |    200 |           25 |
	| 00048 | X-Ray Goggles                |  100.00 | ProtoVision                    |     14 |           15 |
	| 00049 | Babys First Game Console     |  150.00 | Motion Enhanced Technology     |    100 |           20 |
	+-------+------------------------------+---------+--------------------------------+--------+--------------+
	18 rows in set (0.01 sec) */

	
#Pw. List of items that have been rated by at least one buyer before they bought them. No duplication.
	
	delimiter //
	create procedure Pw()
	begin
		with customerBought(customerID, UPC, orderdate) as (select customerID, UPC, orderdate
															from orders join contains using (orderID)),
			 rateBefore(UPC) as (select UPC
										from rated
										where exists(select *
											from customerBought
											 where rated.customerID = customerBought.customerID and
													rated.UPC = customerBought.UPC and
													rated.ratingdate < customerBought.orderdate))
			select *
			from product
			where UPC in (select UPC from rateBefore);
	end//
	delimiter ;
	
	call Pw();
	
	+-------+------------------------------+---------+--------------------------------+--------+--------------+
	| UPC   | Pname                        | price   | Sname                          | amount | reorderlevel |
	+-------+------------------------------+---------+--------------------------------+--------+--------------+
	| 00003 | Happy Smiles Face Paints     |   19.99 | Bel-Art Products               |      3 |           75 |
	| 00005 | Super-Sensor Door Opener     |  120.00 | Motion Enhanced Technology     |      4 |            2 |
	| 00007 | Far Out! Telescope           | 1099.99 | Seatec Astronomy               |      3 |            1 |
	| 00009 | Star Gazer Junior            |   39.99 | Seatec Astronomy               |     55 |           35 |
	| 00011 | Job Hunter Discount Suit     |   74.99 | NK Apparel                     |     44 |           30 |
	| 00012 | Head Secure Hard Hat         |   59.99 | Grainger Industrial Supply     |     40 |           20 |
	| 00013 | The Overclocker: Extreme CPU |  349.99 | Melmarc Products Inc.          |     32 |           30 |
	| 00019 | Summer Dress                 |   19.00 | Bel-Art Products               |    250 |           35 |
	| 00022 | Travel Coffee Maker          |   39.00 | Cambridge Engineered Solutions |     20 |           50 |
	| 00024 | Winter Jacket                |   55.00 | NK Apparel                     |    100 |           20 |
	| 00027 | Printer Paper                |    4.00 | HB Products LLC                |      0 |           50 |
	| 00028 | AC Unit                      | 2000.00 | Large System Distributors      |     10 |            4 |
	| 00030 | Surface Pro 4                |  600.00 | UCA Group Inc.                 |     30 |           10 |
	| 00031 | Sunglasses                   |   50.00 | ProtoVision                    |     75 |           15 |
	| 00032 | Thermal Sensor               |  350.00 | Hadden Industries              |     15 |            3 |
	| 00033 | Digital Clock                |   15.00 | Motion Enhanced Technology     |     30 |          150 |
	| 00034 | Sweater                      |   34.99 | NK Apparel                     |    100 |           25 |
	| 00035 | Transformer Action Figure    |    5.00 | Pegatron Products              |     90 |          250 |
	| 00036 | Star Wars Sticker            |    0.50 | Akustica                       |     50 |         2000 |
	| 00037 | Smartwatch                   |  250.00 | ViTech Scientific              |     50 |           10 |
	| 00044 | Robot Chef                   | 4999.99 | ViTech Scientific              |     75 |           10 |
	| 00045 | Kids Baking Set              |   50.00 | Melmarc Products Inc.          |     20 |           20 |
	| 00046 | Math Card Game               |   10.00 | HB Products LLC                |     13 |           20 |
	| 00050 | Baby Learns German           |   50.00 | Aleris International Inc.      |    175 |           20 |
	+-------+------------------------------+---------+--------------------------------+--------+--------------+
	24 rows in set (0.01 sec) */

	
#Px. List of orders that were shipped fast.

	delimiter //
	create procedure Px(maxDays int)
	begin
		select *
		from orders
		where datediff(shipdate,orderdate) <= maxDays;
	end//
	delimiter ;
	
	call Px(1);
	
 /*	+---------+------------+------------+-------------+------------------+------------+
	| orderID | orderdate  | shipdate   | paymenttype | CCN              | customerID |
	+---------+------------+------------+-------------+------------------+------------+
	|       7 | 2019-02-03 | 2019-02-04 | VISA        | 3245654578765435 |         20 |
	|       9 | 2019-02-09 | 2019-02-10 | MC          | 4345675678909876 |         19 |
	|      10 | 2019-02-10 | 2019-02-11 | DISCOVER    | 1316415311728383 |         49 |
	|      13 | 2019-02-18 | 2019-02-19 | DISCOVER    | 1695220840645544 |         48 |
	|      15 | 2019-02-20 | 2019-02-21 | VISA        | 9876545434323456 |          9 |
	|      16 | 2019-03-01 | 2019-03-02 | VISA        | 3214356453678564 |          2 |
	|      26 | 2019-04-01 | 2019-04-02 | DISCOVER    | 0432928988501514 |         35 |
	|      27 | 2019-04-01 | 2019-04-02 | DISCOVER    | 3277872856792989 |         29 |
	|      28 | 2019-04-01 | 2019-04-02 | MC          | 7423648540714970 |         15 |
	|      29 | 2019-04-01 | 2019-04-02 | MC          | 8070263255919104 |         25 |
	|      53 | 2021-04-17 | 2021-04-18 | DISCOVER    | 6012774573811574 |          5 |
	|      55 | 2021-04-30 | 2021-05-01 | VISA        | 8347756029370204 |         30 |
	|      61 | 2021-11-06 | 2021-11-06 | DISCOVER    | 4210064978513444 |         50 |
	|      62 | 2022-01-03 | 2022-01-04 | DISCOVER    | 1934527846572318 |          1 |
	|      86 | 2022-04-14 | 2022-04-15 | VISA        | 3971406033891543 |         27 |
	|      88 | 2022-04-18 | 2022-04-19 | MC          | 3323459807654356 |         23 |
	|      90 | 2022-04-19 | 2022-04-19 | VISA        | 9876565476587643 |         30 |
	+---------+------------+------------+-------------+------------------+------------+
	17 rows in set (0.00 sec) */
	
	call Px(0);
	
 /*	+---------+------------+------------+-------------+------------------+------------+
	| orderID | orderdate  | shipdate   | paymenttype | CCN              | customerID |
	+---------+------------+------------+-------------+------------------+------------+
	|      61 | 2021-11-06 | 2021-11-06 | DISCOVER    | 4210064978513444 |         50 |
	|      90 | 2022-04-19 | 2022-04-19 | VISA        | 9876565476587643 |         30 |
	+---------+------------+------------+-------------+------------------+------------+
	2 rows in set (0.01 sec) */


	
#Py. List of bestselling products.
	
	delimiter //
	create procedure Py(minPurchase int)
	begin 
		with bestsellingProduct(UPC) as (select UPC
										 from contains
										 group by UPC
										 having count(UPC) >= minPurchase)
		select *
		from product
		where UPC in (select UPC from bestsellingProduct);
	end//
	delimiter ;
	
	call Py(10);
 /*	+-------+-------------------+---------+-------------------------------+--------+--------------+
	| UPC   | Pname             | price   | Sname                         | amount | reorderlevel |
	+-------+-------------------+---------+-------------------------------+--------+--------------+
	| 00023 | Car Stereo System |   60.00 | Kaman Industrial Technologies |     50 |           10 |
	| 00028 | AC Unit           | 2000.00 | Large System Distributors     |     10 |            4 |
	| 00037 | Smartwatch        |  250.00 | ViTech Scientific             |     50 |           10 |
	+-------+-------------------+---------+-------------------------------+--------+--------------+
	3 rows in set (0.00 sec) */
	
	call Py(7);
 /*	+-------+------------------------------+---------+-------------------------------+--------+--------------+
	| UPC   | Pname                        | price   | Sname                         | amount | reorderlevel |
	+-------+------------------------------+---------+-------------------------------+--------+--------------+
	| 00001 | Xtreme Graphics 5000         |  399.99 | Melmarc Products Inc.         |     50 |           10 |
	| 00003 | Happy Smiles Face Paints     |   19.99 | Bel-Art Products              |      3 |           75 |
	| 00005 | Super-Sensor Door Opener     |  120.00 | Motion Enhanced Technology    |      4 |            2 |
	| 00007 | Far Out! Telescope           | 1099.99 | Seatec Astronomy              |      3 |            1 |
	| 00008 | Bass Booster Subwoofers      |  124.99 | Melmarc Products Inc.         |      3 |           10 |
	| 00009 | Star Gazer Junior            |   39.99 | Seatec Astronomy              |     55 |           35 |
	| 00010 | Sunshine Yellow              |   44.99 | Bel-Art Products              |     10 |           15 |
	| 00012 | Head Secure Hard Hat         |   59.99 | Grainger Industrial Supply    |     40 |           20 |
	| 00013 | The Overclocker: Extreme CPU |  349.99 | Melmarc Products Inc.         |     32 |           30 |
	| 00014 | DG Camera                    |  120.00 | ProtoVision                   |    150 |           20 |
	| 00016 | Chef Gourmet Pasta           |    8.00 | PolyOne                       |     50 |           10 |
	| 00017 | Portable Motion Detector     |   50.00 | Motion Enhanced Technology    |      5 |           10 |
	| 00018 | Smart Cooker                 |   65.00 | Pegatron Products             |    150 |           20 |
	| 00019 | Summer Dress                 |   19.00 | Bel-Art Products              |    250 |           35 |
	| 00023 | Car Stereo System            |   60.00 | Kaman Industrial Technologies |     50 |           10 |
	| 00024 | Winter Jacket                |   55.00 | NK Apparel                    |    100 |           20 |
	| 00027 | Printer Paper                |    4.00 | HB Products LLC               |      0 |           50 |
	| 00028 | AC Unit                      | 2000.00 | Large System Distributors     |     10 |            4 |
	| 00030 | Surface Pro 4                |  600.00 | UCA Group Inc.                |     30 |           10 |
	| 00031 | Sunglasses                   |   50.00 | ProtoVision                   |     75 |           15 |
	| 00033 | Digital Clock                |   15.00 | Motion Enhanced Technology    |     30 |          150 |
	| 00035 | Transformer Action Figure    |    5.00 | Pegatron Products             |     90 |          250 |
	| 00036 | Star Wars Sticker            |    0.50 | Akustica                      |     50 |         2000 |
	| 00037 | Smartwatch                   |  250.00 | ViTech Scientific             |     50 |           10 |
	| 00038 | Winnie the Pooh Book         |    7.99 | C. C. Filson                  |     80 |           20 |
	| 00039 | Calculus Book                |   50.00 | HB Products LLC               |    250 |           50 |
	| 00040 | Basic Telescope              |  100.00 | Seatec Astronomy              |     10 |           25 |
	| 00041 | High End Telescope           |  100.00 | Seatec Astronomy              |    100 |           20 |
	| 00042 | Gerber Baby Food             |    5.00 | HB Products LLC               |      0 |           50 |
	| 00044 | Robot Chef                   | 4999.99 | ViTech Scientific             |     75 |           10 |
	| 00045 | Kids Baking Set              |   50.00 | Melmarc Products Inc.         |     20 |           20 |
	| 00048 | X-Ray Goggles                |  100.00 | ProtoVision                   |     14 |           15 |
	+-------+------------------------------+---------+-------------------------------+--------+--------------+
	32 rows in set (0.00 sec) */

		
#Pz. A suggested list of products for this specific customer.
#Chose to have other values be used as thresholds that must be met to be counted.

		delimiter //
		create procedure Pz(specCust int, minNumRating int, minRating int, minSales int)
		begin
			with customerBought(UPC) as (select UPC
										 from contains join orders using (orderID)
										 where customerID = specCust),
			customerCategories(category) as (select category
												  from prod_category
												  where UPC in (select UPC from customerBought)),
			custCatProducts(UPC) as (select UPC 
									 from prod_category
									 where category in (select category from customerCategories)),
			highRateNCountRecs(UPC) as (select UPC
										from custCatProducts left join rated using (UPC)
										group by UPC
										having count(rating) >= minNumRating and avg(rating) >= minRating),
			bestsellingRecs(UPC) as (select UPC
									  from highRateNCountRecs left join contains using (UPC)
									  group by UPC
									  having count(*) >= minSales)
			select *
			from product
			where UPC in (select UPC from bestsellingRecs);
		end//
		delimiter ;
		
		call Pz(1, 10, 4, 5)//
		
 /*		+-------+--------------------------+--------+----------------------------+--------+--------------+
		| UPC   | Pname                    | price  | Sname                      | amount | reorderlevel |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		| 00014 | DG Camera                | 120.00 | ProtoVision                |    150 |           20 |
		| 00019 | Summer Dress             |  19.00 | Bel-Art Products           |    250 |           35 |
		| 00040 | Basic Telescope          | 100.00 | Seatec Astronomy           |     10 |           25 |
		| 00045 | Kids Baking Set          |  50.00 | Melmarc Products Inc.      |     20 |           20 |
		| 00049 | Babys First Game Console | 150.00 | Motion Enhanced Technology |    100 |           20 |
		| 00050 | Baby Learns German       |  50.00 | Aleris International Inc.  |    175 |           20 |
		+-------+--------------------------+--------+----------------------------+--------+--------------+
		6 rows in set (0.01 sec) */
		
		call Pz(1, 4, 3, 10)//
		
 /*		+-------+-------------------+---------+-------------------------------+--------+--------------+
		| UPC   | Pname             | price   | Sname                         | amount | reorderlevel |
		+-------+-------------------+---------+-------------------------------+--------+--------------+
		| 00023 | Car Stereo System |   60.00 | Kaman Industrial Technologies |     50 |           10 |
		| 00028 | AC Unit           | 2000.00 | Large System Distributors     |     10 |            4 |
		+-------+-------------------+---------+-------------------------------+--------+--------------+
		2 rows in set (0.01 sec) */


#aa. Set up an Alert table and a trigger that logs new orders for amounts larger than 20 of the same product.
	
	create table Alert(
			aid int primary key auto_increment,
			orderID int not null,
			UPC char(5) not null,
			quantity int not null,
			alert_type varchar(25) not null
	);
	delimiter //
	create trigger contains_largerthantwentyquantity after insert on contains
	for each row
	begin
		if new.quantity > 20 then
			insert into Alert values(0, new.orderID, new.UPC, new.quantity, "over 20 of one item");
		end if;
	end//
	delimiter ;
	
	insert into contains values ('1', '00001', 21);
 /*	+-----+---------+-------+----------+---------------------+
	| aid | orderID | UPC   | quantity | alert_type          |
	+-----+---------+-------+----------+---------------------+
	|   1 |       1 | 00001 |       21 | over 20 of one item |
	+-----+---------+-------+----------+---------------------+
	1 row in set (0.00 sec) */


#bb. Set up a trigger of our choosing that is not related to the trigger in aa or is using the Alert table. Make sure to document it thoroughly.
	
	#Creates a trigger that keeps fro a items inventory becoming less than 0.
	delimiter //
	create trigger minAmountZero before update on product
	for each row
	begin
	if(new.amount <= 0) then
		set new.amount = 0;
	end if;
	end//
	delimiter ;
	
 /*	+-------+-------------------------+-------+------------+--------+--------------+
	| UPC   | Pname                   | price | Sname      | amount | reorderlevel |
	+-------+-------------------------+-------+------------+--------+--------------+
	| 00002 | Sure Feet Running Shoes | 59.99 | NK Apparel |      6 |           30 |
	+-------+-------------------------+-------+------------+--------+--------------+
	1 row in set (0.03 sec) */
	
	update product set amount = -10  where UPC = '00002'//

 /*	+-------+-------------------------+-------+------------+--------+--------------+
	| UPC   | Pname                   | price | Sname      | amount | reorderlevel |
	+-------+-------------------------+-------+------------+--------+--------------+
	| 00002 | Sure Feet Running Shoes | 59.99 | NK Apparel |      0 |           30 |
	+-------+-------------------------+-------+------------+--------+--------------+
	1 row in set (0.00 sec) */
